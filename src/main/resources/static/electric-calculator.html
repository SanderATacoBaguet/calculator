<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Electric Calculator</title>
<link rel="stylesheet" href="style.css">
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
.resistor-group { margin-bottom: 10px; }
button { margin-top: 10px; }
.output { white-space: pre-line; margin-top: 20px; background: #f0f0f0; padding: 10px; border-radius: 5px; }
</style>
</head>
<body>

<h1>Dynamic Electric Circuit Calculator</h1>

<div id="resistors-container"></div>
<button onclick="addResistor()">Add Resistor</button>
<button onclick="calculateCircuit()">Calculate</button>

<div class="output" id="output"></div>

<script>
let counter = 1;

function addResistor() {
    const container = document.getElementById('resistors-container');
    const div = document.createElement('div');
    div.className = 'resistor-group';
    div.id = `resistor${counter}`;
    div.innerHTML = `
        <label>Resistor name (e.g., R1 or Rp1): 
            <input type="text" name="name" value="R${counter}" required>
        </label>
        <label>Value (Î©):
            <input type="number" name="value" value="10" step="0.01" required>
        </label>
        <label>Type:
            <select name="type">
                <option value="series">Series</option>
                <option value="parallel">Parallel</option>
            </select>
        </label>
        <button onclick="removeResistor(${counter})">Remove</button>
    `;
    container.appendChild(div);
    counter++;
}

function removeResistor(id) {
    document.getElementById(`resistor${id}`).remove();
}

function calculateCircuit() {
    const outputEl = document.getElementById('output');
    const container = document.getElementById('resistors-container');
    const groups = container.getElementsByClassName('resistor-group');

    // Build input data
    const data = [];
    for (const group of groups) {
        const name = group.querySelector('input[name="name"]').value;
        const value = parseFloat(group.querySelector('input[name="value"]').value);
        const type = group.querySelector('select[name="type"]').value;
        data.push({ name, value, type });
    }

    // Send to backend (or calculate locally)
    fetch('/api/autocalc', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ resistors: data })
    })
    .then(res => res.json())
    .then(json => {
        outputEl.innerText = json.output;
    })
    .catch(err => outputEl.innerText = "Error: " + err);
}
</script>

</body>
</html>
